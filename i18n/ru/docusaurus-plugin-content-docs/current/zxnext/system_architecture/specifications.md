---
sidebar_position: 10
title: Спецификация
---

> Это перевод официальной документации. Оригинальный англоязычный документ находится тут https://wiki.specnext.dev/Specifications

Ядро ZX Spectrum Next еще не завершено, но цель - закончить ко второму кикстартеру. Тем не менее, большая часть запланированной функциональности уже реализована.

Краткая информация о текущих технических характеристиках машины:

* **CPU** : Центральный процессор Z80N (совместимый с z80 с некоторыми дополнительными инструкциями), работающий на программно выбираемых скоростях 3,5 МГц, 7 МГц, 14 МГц или 28 МГц с состояниями ожидания.

* **COPPER** : Сопроцессор, работающий независимо от центрального процессора, выполняющий простые инструкции, которые могут изменять состояние регистров nextreg. Например, он может менять палитру, изменять режим отображения или воспроизводить стереофоническую музыку. Сопроцессор синхронизирован с генерацией дисплея, поэтому он может вносить эти изменения в точные места на дисплее.

* **DMA** : ZXN DMA, совместимый с подмножеством чипа Z80 DMA, способен выполнять передачи между памятью и/или портами ввода-вывода с помощью коротких двухцикловых операций чтения и записи. В пакетном режиме ZXN DMA может посылать байты с программируемой скоростью, что позволяет ему воспроизводить сэмплированную музыку, возвращая управление процессору между передачами. В это время ZXN DMA и процессор делят шину, и DMA работает на установленной в данный момент скорости процессора.

* **ПАМЯТЬ ОЗУ** : 768K оперативной памяти в нерасширенной машине или 1792K оперативной памяти в расширенной машине. Эта память доступна в банках по 16K, как в оригинальных 128K Spectrum'ах, и может быть отображена, как обычно, с помощью стандартных портов `0x7ffd` и `0x1ffd`. Дополнительный порт `0xdffd` добавляет биты к порту `0x7ffd` для доступа ко всем банкам памяти. Собственная схема переключения банков в ZX Spectrum Next называется MMU. Эта схема делит одну и ту же память на страницы по 8K и позволяет любой странице быть отображенной в любой 8К слот 64К адресного пространства Z80.

* **ПАМЯТЬ ПЗУ** : 64K ПЗУ зарезервировано для ПЗУ 0-3, как в Spectrum +3. Также доступно 32К альтернативного ПЗУ, которое может заменить обычные ПЗУ; это ПЗУ программируется пользователем.

* **ГРАФИКА** : Дисплей состоит из слоев с программируемым приоритетом. Слои перечислены ниже.

  * **ULA** : Совместимость по таймингам, задержкам и поведению плавающей шины с 48k, 128k, +3 машинами и Pentagon. Поддерживает аппаратную прокрутку пикселей в направлениях X и Y и следующие разрешения:
  	* 256x192 пикселей и 32x24 знакомест атрибутов в банке 5 (48k / 128k)
  	* 256x192 пикселей и 32x24 знакомест атрибутов в банке 7 (128k, второй экран)
  	* 256x192 пикселей и 32x24 знакомест атрибутов по адресу 0x6000 в банке 5 (второй экран в Timex)
	* 256x192 пикселей и 32x192 знакомест атрибутов по адресам 0x4000 и 0x6000 в банке 5 (режим Timex Hi-colour)
  	* 512x192 пикселей в монохромном режиме по адресам 0x4000 и 0x6000 в банке 5 (Timex Hi-res)
	
  * **LoRes** : Занимает тот же слой, что и ULA, при этом LoRes заменяет ULA там, где он включен. Поддерживает аппаратную прокрутку пикселей в направлениях X и Y. Доступны два разрешения:
  	* 128x96 пикселей 4-битного цвета на каждый пиксель либо по адресу 0x4000, либо 0x6000 в банке 5 (Режим Radastan появившийся на ZX UNO)
  	* 128x96 пикселей 8-битного цвета на каждый пиксель, занимающий блоки 0x4000 и 0x6000 в банке 5

  * **Layer 2** : Пиксельное отображение без смешения цветов. Поддерживает аппаратную пиксельную прокрутку в направлениях X и Y. Может быть отображен на любое место в памяти, начинаясь по границам блоков в 16K. Доступные разрешения:
  	* 256x192 8-битного цвета на каждый пиксель
  	* 320x256 8-битного цвета на каждый пиксель
  	* 640x256 4-битного цвета на каждый пиксель

  * **Спрайты** : До 128 аппаратных спрайтов размером 16x16 пикселей с 8 или 4 битами цвета на пиксель.  При таком размере можно отобразить не менее 100 спрайтов в строке.  Спрайты можно масштабировать 1х 2х 4х 8х, поворачивать, зеркально отображать и соединять вместе.

  * **Tilemap** : Тайловая карта - аппаратный символьный дисплей с двумя разрешениями (80x32 = 640x256 пикселей, 40x32 = 320x256). Поддерживает аппаратную прокрутку пикселей в направлениях X и Y. Карта символов и глифы хранятся в программируемых местах в банке 5. Отдельные символы могут быть независимо повернуты и зеркально отображены. Каждый глиф имеет размер 8x8 пикселей с 4 битами цвета на пиксель. Другой режим исключает вращение и зеркальное отображение в пользу глифов размером 8x8 пикселей, определенных как монохромные UDG, но с большей информацией о цвете, хранящейся в карте символов.

  Некоторые режимы приоритета слоём позволяют слою Layer 2 быть выделенным или затемненным ULA. Другая настройка позволяет Tilemap и ULA накладываться друг на друга.

* **ЗВУК** : Стерео звук проигрывается через HDMI, 3.5мм аудио джек или опциональный внутренний динамик. источники звука:
  * **Бипер** : Простые звуки и запись на кассету.
  * **3 сопроцессора AY 8910** : Аранжировка совместима с двойным расположением TurboSound. Каждый AY может быть запрограммирован как в моно, так и в стерео режиме ABC или ACB.
* **8-битные ЦАПы (4 штуки)** : Два ЦАПа подключены к левому каналу и два - к правому. К этим ЦАПам привязаны распространенные в спектрумовском сообществе 8-битные периферийные устройства, такие как SpecDrum и Soundrive.
* **Raspberry PI I2S** : Аудио, генерируемое дополнительным ускорителем Pi, может быть подмешано во внутренний следующий аудиопоток или может быть выведено к разъёму EAR для записи на ленту.
